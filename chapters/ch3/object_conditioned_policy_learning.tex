\chapter{Proposed object conditioned control policy}
\label{ch:occp}
In this chapter, the main contribution of this thesis will be presented: the \textit{Object Conditioned Control Policy} (OCCP). As outlined in Section \ref{sec:motivation}, the central challenge addressed in this thesis is \textit{target-object misidentification} within Visual-Conditioned Multi-Task Imitation Learning systems. To tackle this issue, a modular control architecture is proposed, based on the hypothesis that separating the cognitive task from the control task into distinct modules can improve the overall robustness and interpretability of these systems. 

Specifically, Section \ref{sec:occp_related_works} provides an in-depth review of prior research in the fields of Multi-Task Imitation Learning and Object-Oriented Imitation Learning, which are most relevant to the proposed approach. Section \ref{sec:ocpl_problem} defines the problem being addressed, presenting formal definitions and high-level architectures. In contrast, Section \ref{sec:ocpl_architecture} describes the proposed methods to solve the problem, with a particular focus on how the proposed Conditioned Object Detector (Chapter \ref{ch:cod}) has been integrated into the control module. Finally, Section \ref{sec:ocpl_experimental} discusses the experimental setup and presents the results obtained from evaluating the proposed architecture.


\input{chapters/ch3/related_works.tex}
\input{chapters/ch3/problem_formulation.tex}
\input{chapters/ch3/proposed_architecture.tex}
\input{chapters/ch3/experimental_results.tex}

\section{Conclusion}
In conclusion, this chapter introduced and discussed the Object Conditioned Control Policy (OCCP), a modular control architecture designed to incorporate the Conditioned Object Detector. This integration enables the control policy to utilize low-dimensional positional information about the target object's location, while the Control Module Backbone produces an embedding that captures task-relevant information. This embedding is derived from gradients computed through backpropagation of an action-centric loss function, effectively addressing or mitigating the target-object misidentification issues observed in baseline models.


Two specific control architectures were proposed: MOSAIC-CTOD, which integrates the Conditioned Target Object Detector, and MOSAIC-COD, which incorporates the Conditioned Object Detector. The latter generates both the bounding box of the target object and the bounding box of the target position of interest. These architectures were validated in a simulation environment under both single-task multi-variation and multi-task multi-variation scenarios. The results demonstrated that incorporating object-related information allowed the system to consistently reach and pick the target object, resulting in successful task completion.


In the single-task scenario, MOSAIC-COD achieved the highest average success rate (\textbf{90.13\%}), representing a $+28.77\%$ improvement over the MOSAIC baseline. In the multi-task scenario, MOSAIC-COD achieved an average success rate of \textbf{79.24\%}, improving by $+33.23\%$ compared to the baseline. The most significant improvements from object conditioning were observed in tasks involving ``pick-place" primitives, such as Pick-Place, Nut-Assembly, and Stack-Block. However, a general performance drop was noted in the Press-Button task, where variations in bounding-box predictions led to unstable robot behaviors.

Additional notable improvements were observed when proprioceptive information (e.g., joint positions and gripper state) was integrated. Specifically, the Nut-Assembly task, which requires precise, contact-rich manipulation, saw the highest gains. For MOSAIC-CTOD-P, the average success rate reached \textbf{95.06\%}, marking an improvement of $+30.99\%$ over the version without proprioceptive data. This success was attributed to the fixed positions of the target pegs, where joint position information helped the robot avoid collisions and correctly insert the pegs. Moreover, the proposed architecture demonstrated zero-shot generalization to novel variations, with MOSAIC-COD achieving an average success rate of \textbf{81.57\%} in the single-task scenario and \textbf{85.45\%} in the multi-task scenario. This represents improvements of $+48.79\%$ and $+53.32\%$ over the MOSAIC baseline, respectively.

Overall, the introduction of inferred object priors led to significant improvements over the baseline. However, further refinements in the learning process, particularly in multi-task scenarios, are needed. Specifically, future work should account for the varying difficulties of different tasks in these scenarios.